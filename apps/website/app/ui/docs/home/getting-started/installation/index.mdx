import { CodeBlock } from "@/components/custom/markdown/code-block"; 

import {
  UtilsLink,
  OverlayLink,
  ToastLink,
  GluestackUIProviderLink,
} from './utils-link';
import { Tabs, TabItem } from '@/docs-components/tabs';
import {
  Table,
  TableHeader,
  TableCell,
  TableHeaderCell,
  TableBody,
  TableRow,
} from '@/docs-components/table';
import { InlineCode } from '@/docs-components/inline-code';

# Installation

To get started with **gluestack-ui {`${process.env.NEXT_PUBLIC_GLUESTACK_VERSION || 'v4'}`}**, check out this quick installation guide. It provides simple steps to help you install and use the library in your projects.

<Tabs>
<TabItem label="CLI">
### Step 1: Setup your project

If you are starting with a new project, setup your project with [Next.js](https://nextjs.org/docs/getting-started/installation) or [Expo](https://docs.expo.dev/get-started/create-a-project/) If you already have a project, you can skip this step.

### Prerequisites

Ensure you have the following prerequisites installed on your project to use gluestack-ui CLI:

<Table>
<TableHeader>
  <TableRow>
    <TableHeaderCell>Package Name</TableHeaderCell>
    <TableHeaderCell>Supported Versions</TableHeaderCell>
    <TableHeaderCell>Upcoming Support</TableHeaderCell>
  </TableRow>
</TableHeader>
<TableBody>
  <TableRow>
    <TableCell><InlineCode>next</InlineCode></TableCell>
    <TableCell> 13 {"<="} versions {"<="} 15</TableCell>
    <TableCell>-</TableCell>
  </TableRow>
 <TableRow>
    <TableCell><InlineCode>react-native</InlineCode></TableCell>
    <TableCell>versions >= 72.5</TableCell>
    <TableCell>-</TableCell>
  </TableRow>
  <TableRow>
    <TableCell><InlineCode>expo</InlineCode></TableCell>
    <TableCell>versions >= 50</TableCell>
    <TableCell>-</TableCell>
  </TableRow>
   <TableRow>
    <TableCell><InlineCode>node</InlineCode></TableCell>
    <TableCell>versions > 16</TableCell>
    <TableCell>-</TableCell>
  </TableRow>

  </TableBody>
</Table>
### Step 2: Initialize

Go to your project, and use the `init` command at the root of your project to add `GluestackUIProvider` and essential components (`icon`, `overlay`, `toast`) to your project.

<CodeBlock
  code={`${process.env.NEXT_PUBLIC_GLUESTACK_COMMAND || 'npx gluestack-ui'} init`}
  language="bash"
/>

Your project is now ready to use **gluestack-ui** components. To add gluestack-ui components to your project using the CLI, refer to the above command or use the [CLI guide](/ui/docs/home/getting-started/cli).

<CodeBlock
  code={`${process.env.NEXT_PUBLIC_GLUESTACK_COMMAND || 'npx gluestack-ui'} add box`}
  language="bash"
/>

If you encounter issues during the CLI installation, refer to the manual installation guide available.

</TabItem>
<TabItem label="Manual">
### Step 1: Setup your project.

Setup nativewind in your project following [NativeWind documentation](https://www.nativewind.dev/docs/getting-started/installation).

### Step 2: Install dependencies and devDependencies

Install the dependencies and devDependencies of gluestack-ui in your project. This can be done using the following command:

<Tabs>
<TabItem label="Next.js">
```bash
npm i @gluestack-ui/core@alpha @gluestack-ui/utils@alpha react-native-reanimated@~4.2.1 react-native-worklets@^0.7.1 @legendapp/motion@^2.4.0 tailwind-variants@^0.1.20 react-native-svg@^15.12.0 nativewind@^4.1.23 @gluestack/ui-next-adapter@alpha react-native-web@^0.20.0 react-native-safe-area-context@^5.6.1 react-aria@^3.41.1 react-stately@^3.39.0 dom-helpers@^5.2.1
```

OR

```bash
yarn add @gluestack-ui/core@alpha @gluestack-ui/utils@alpha react-native-reanimated@~4.2.1 react-native-worklets@^0.7.1 @legendapp/motion@^2.4.0 tailwind-variants@^0.1.20 react-native-svg@^15.12.0 nativewind@^4.1.23 @gluestack/ui-next-adapter@alpha react-native-web@^0.20.0 react-native-safe-area-context@^5.6.1 react-aria@^3.41.1 react-stately@^3.39.0 dom-helpers@^5.2.1
```
</TabItem>
<TabItem label="Expo / React Native">
```bash
npm i @gluestack-ui/core@alpha @gluestack-ui/utils@alpha react-native-reanimated@~4.2.1 react-native-worklets@^0.7.1 @legendapp/motion@^2.4.0 tailwind-variants@^0.1.20 react-native-svg@^15.12.0 nativewind@^4.1.23 react-native-safe-area-context@^5.6.1 react-aria@^3.41.1 @expo/html-elements@^0.12.5 react-stately@^3.39.0
```

OR

```bash
yarn add @gluestack-ui/core@alpha @gluestack-ui/utils@alpha react-native-reanimated@~4.2.1 react-native-worklets@^0.7.1 @legendapp/motion@^2.4.0 tailwind-variants@^0.1.20 react-native-svg@^15.12.0 nativewind@^4.1.23 react-native-safe-area-context@^5.6.1 react-aria@^3.41.1 @expo/html-elements@^0.12.5 react-stately@^3.39.0
```
</TabItem>
</Tabs>

It's recommended to use the `--legacy-peer-deps` flag due to peer dependency resolution issues.

```bash
npm i <packages> --legacy-peer-deps
```

> **Animation Libraries:** In gluestack-ui v4, we use `react-native-reanimated` (~4.2.1) for most animated components (Accordion, Drawer, Modal, Menu, Popover, Toast) and `@legendapp/motion` (^2.4.0) for other components (Tooltip, ActionSheet, Select). The CLI automatically installs the required dependencies for your project.

### Step 3: Configure Babel (Expo/React Native only)

For Expo and React Native CLI projects, you need to add the `react-native-worklets/plugin` to your `babel.config.js`:

```js
module.exports = function (api) {
  api.cache(true);
  return {
    presets: [
      // your existing presets
      'babel-preset-expo', // or '@react-native/babel-preset' for RN CLI
    ],
    plugins: [
      // your existing plugins
      'react-native-worklets/plugin', // Add this line
    ],
  };
};
```

> **Note:** The `react-native-worklets/plugin` must be included for `react-native-reanimated` to work properly.

### Step 4: Copy required components

- Copy all the contents of the GluestackUIProvider folder from the{" "}<GluestackUIProviderLink />{" "}into your project's `@/components/ui/gluestack-ui-provider` directory.

### Step 5: Update Configuration Files

You need to update the following configuration files in the root of your project. Replace the content of each file with the provided code blocks below. If a file does not exist, create it manually.

> **(For Expo/React Native)** Make sure `global.css` is in the project root. If not, update its path in `metro.config.js` and `app/layout.tsx`.

#### Step 5.1: Update Tailwind configuration

Update the `tailwind.config.js` file with the following code and also the `content` property with paths to the files where components are used.

> **Note:** gluestack-ui v4 uses a shadcn-inspired color token system with semantic naming (primary, secondary, accent, muted, etc.) for better theming consistency.

```js
/** @type {import('tailwindcss').Config} */
module.exports = {
  darkMode: process.env.DARK_MODE ? process.env.DARK_MODE : 'media',
  content: [
    './app/**/*.{html,js,jsx,ts,tsx,mdx}',
    './components/**/*.{html,js,jsx,ts,tsx,mdx}',
    './utils/**/*.{html,js,jsx,ts,tsx,mdx}',
  ],
  presets: [require('nativewind/preset')],
  important: 'html',
  safelist: [
    {
      pattern:
        /(bg|border|text|stroke|fill)-(foreground|card|popover|muted|destructive|border|input|ring|white|chart|sidebar|primary|secondary|typography|background|accent)(\/\d+)?$/,
    },
    {
      pattern:
        /(bg|border|text|stroke|fill)-(card|popover|muted|destructive|primary|secondary|accent|sidebar)-(foreground)(\/\d+)?$/,
    },
  ],
  theme: {
    extend: {
      colors: {
        foreground: 'rgb(var(--foreground)/<alpha-value>)',
        card: {
          DEFAULT: 'rgb(var(--card) / <alpha-value>)',
          foreground: 'rgb(var(--card-foreground) / <alpha-value>)',
        },
        popover: {
          DEFAULT: 'rgb(var(--popover) / <alpha-value>)',
          foreground: 'rgb(var(--popover-foreground) / <alpha-value>)',
        },
        muted: {
          DEFAULT: 'rgb(var(--muted) / <alpha-value>)',
          foreground: 'rgb(var(--muted-foreground) / <alpha-value>)',
        },
        destructive: {
          DEFAULT: 'rgb(var(--destructive) / <alpha-value>)',
        },
        border: 'rgb(var(--border)/<alpha-value>)',
        input: 'rgb(var(--input)/<alpha-value>)',
        ring: 'rgb(var(--ring) / <alpha-value>)',
        white: 'rgb(255 255 255)',
        // Chart colors
        chart: {
          1: 'rgb(var(--chart-1) / <alpha-value>)',
          2: 'rgb(var(--chart-2) / <alpha-value>)',
          3: 'rgb(var(--chart-3) / <alpha-value>)',
          4: 'rgb(var(--chart-4) / <alpha-value>)',
          5: 'rgb(var(--chart-5) / <alpha-value>)',
        },

        // Sidebar colors
        sidebar: {
          'DEFAULT': 'rgb(var(--sidebar) / <alpha-value>)',
          'foreground': 'rgb(var(--sidebar-foreground) / <alpha-value>)',
          'primary': 'rgb(var(--sidebar-primary) / <alpha-value>)',
          'primary-foreground':
            'rgb(var(--sidebar-primary-foreground) / <alpha-value>)',
          'accent': 'rgb(var(--sidebar-accent) / <alpha-value>)',
          'accent-foreground':
            'rgb(var(--sidebar-accent-foreground) / <alpha-value>)',
          'border': 'rgb(var(--sidebar-border))',
          'ring': 'rgb(var(--sidebar-ring) / <alpha-value>)',
        },

        primary: {
          DEFAULT: 'rgb(var(--primary)/<alpha-value>)',
          foreground: 'rgb(var(--primary-foreground)/<alpha-value>)',
        },

        secondary: {
          DEFAULT: 'rgb(var(--secondary)/<alpha-value>)',
          foreground: 'rgb(var(--secondary-foreground)/<alpha-value>)',
        },

        typography: {
          white: '#FFFFFF',
          gray: '#D4D4D4',
          black: '#181718',
        },

        background: {
          DEFAULT: 'rgb(var(--background)/<alpha-value>)',
        },
        accent: {
          DEFAULT: 'rgb(var(--accent)/<alpha-value>)',
          foreground: 'rgb(var(--accent-foreground)/<alpha-value>)',
        },
      },
      fontFamily: {
        heading: undefined,
        body: 'var(--font-sans)',
        mono: 'var(--font-mono)',
        sans: 'var(--font-sans)',
        serif: 'var(--font-serif)',
        inter: ['var(--font-inter)'],
        georgia: ['Georgia'],
        melno: ['Melno'],
        andika: [
          'Andika_400Regular',
          'Andika_400Regular_Italic',
          'Andika_700Bold',
          'Andika_700Bold_Italic',
        ],
        outfit: [
          'Outfit_400Regular',
          'Outfit_500Medium',
          'Outfit_600SemiBold',
          'Outfit_700Bold',
          'Outfit_800ExtraBold',
          'Outfit_900Black',
        ],
      },
      fontWeight: {
        extrablack: '950',
      },
      fontSize: {
        '2xs': '10px',
      },
      boxShadow: {
        'hard-1': '-2px 2px 8px 0px rgba(38, 38, 38, 0.20)',
        'hard-2': '0px 3px 10px 0px rgba(38, 38, 38, 0.20)',
        'hard-3': '2px 2px 8px 0px rgba(38, 38, 38, 0.20)',
        'hard-4': '0px -3px 10px 0px rgba(38, 38, 38, 0.20)',
        'hard-5': '0px 2px 10px 0px rgba(38, 38, 38, 0.10)',
        'soft-1': '0px 0px 10px rgba(38, 38, 38, 0.1)',
        'soft-2': '0px 0px 20px rgba(38, 38, 38, 0.2)',
        'soft-3': '0px 0px 30px rgba(38, 38, 38, 0.1)',
        'soft-4': '0px 0px 40px rgba(38, 38, 38, 0.1)',
      },
    },
  },
};

```

#### Step 5.2: Configure components path

Create a `components/ui` folder inside `src` folder and add path in `tsconfig.json`

```json
  // ... (other configs)
  compilerOptions: {
    // ...
    "paths": {
      // ...
      "@/*": ["./*"] // Add relative path
    },
  }
```

#### Step 5.3: Configure GluestackUIProvider in project

Wrap your app with `GluestackUIProvider` in `App.tsx`.

```tsx
// App.tsx
import { GluestackUIProvider } from '@/components/ui/gluestack-ui-provider';
import '@/global.css'; // Make sure this path is correct

export default function App() {
  return (
    <GluestackUIProvider>{/* Add your app code here */}</GluestackUIProvider>
  );
}
```

### Step 6: Update Next config file. (Next.js Only).

Make sure your `next.config` file look like this, as mentioned below.

```js
import { withGluestackUI } from '@gluestack/ui-next-adapter';
/** @type {import('next').NextConfig} */
const nextConfig = {
  eslint: {
    ignoreDuringBuilds: true,
  },
  typescript: {
    ignoreBuildErrors: true,
  },
  transpilePackages: [],
};

export default withGluestackUI(nextConfig);

```

### Step 7: Server-side rendering (SSR) (Next.js Only).

It's also recommended to set up your server-side rendering (SSR) correctly. To do this, you will need to use the `flush()` function exported by the `@/utils/gluestack-utils/nativewind-utils`

<Tabs>
<TabItem label="App Router">
(**For Next-15+ only**) For Next.js App Routers we will create a new `registry.tsx` file in the `app` folder of your project and use the flush function from `utils/gluestack-utils/nativewind-utils/flush`

```tsx
'use client';
import React, { useRef, useState } from 'react';
import { useServerInsertedHTML } from 'next/navigation';
import { StyleRegistry, createStyleRegistry } from 'styled-jsx';
import { AppRegistry } from 'react-native-web';
import { flush } from '@gluestack-ui/utils/nativewind-utils';

export default function StyledJsxRegistry({
  children,
}: {
  children: React.ReactNode;
}) {
  // Only create stylesheet once with lazy initial state
  // x-ref: https://reactjs.org/docs/hooks-reference.html#lazy-initial-state
  const [jsxStyleRegistry] = useState(() => createStyleRegistry());

  const isServerInserted = useRef(false);

  useServerInsertedHTML(() => {
    AppRegistry.registerComponent('Main', () => 'main');
    const { getStyleElement } = AppRegistry.getApplication('Main');
    if (!isServerInserted.current) {
      isServerInserted.current = true;
      const styles = [
        getStyleElement(),
        jsxStyleRegistry.styles(),
        flush(),
      ].filter(Boolean); // Remove any null/undefined styles

      jsxStyleRegistry.flush();

      // Add unique keys to each style element
      return (
        <>
          {styles.map((style, index) => (
            <React.Fragment key={`style-${index}`}>{style}</React.Fragment>
          ))}
        </>
      );
    }
  });

  return <StyleRegistry registry={jsxStyleRegistry}>{children}</StyleRegistry>;
}

```

- (**For Next-15+ only**) We also need to wrap `children` with `StyledJsxRegistry` in the `layout.tsx` file.

```jsx
"use client";
import "./globals.css";  // Make sure this path is correct
import { GluestackUIProvider } from "@/components/ui/gluestack-ui-provider";
import StyledJsxRegistry from "./registry";

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body style={{ display: "flex" }}>
        <StyledJsxRegistry>
          <GluestackUIProvider mode="light">{children}</GluestackUIProvider>
        </StyledJsxRegistry>
      </body>
    </html>
  );
}

```

</TabItem>
<TabItem label="Page Router">

Wrap your app with `GluestackUIProvider` in `App.tsx`.

```tsx
// App.tsx
export default function App() {
  return (
    <GluestackUIProvider>{/* Add your app code here */}</GluestackUIProvider>
  );
}
```

For Page Router we will add `registry` code in `_document.tsx` file.

```tsx
import * as React from 'react';
import { Html, Head, Main, NextScript } from 'next/document';
import { AppRegistry } from 'react-native-web';
import { flush } from '@gluestack-ui/nativewind-utils/flush';

function Document() {
  return (
    <Html className="gs" lang="en">
      <Head />
      <body>
        <Main />
        <NextScript />
      </body>
    </Html>
  );
}

Document.getInitialProps = async ({ renderPage }: any) => {
  AppRegistry.registerComponent('Main', () => Main);
  const { getStyleElement } = AppRegistry.getApplication('Main');
  const page = await renderPage();
  const styles = [getStyleElement(), flush()];
  return { ...page, styles: React.Children.toArray(styles) };
};

export default Document;
```

</TabItem>
</Tabs>

</TabItem>
</Tabs>

## Common issues

**Expo app stuck in `tailwindcss(ios) rebuilding...` while running `expo start` command**

In this case, you may have your app stored in a directory with a name containing spaces, such as 'Expo App', renaming it to just 'Expo-App' will resolve the issue.